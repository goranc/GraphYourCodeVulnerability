# Graph Your Code Vulnerability

<p align="center">
  <br> English | <a href="README_zh-CN.md">中文</a>
</p>

## Which data we collect ?

#### GitHub data
- Repository name
- Libraries and exec code in repository
- Links to other repositories
#### CVE & NVD data
- CVE name
- Description
- CVSS v3 Base Score
- Known Affected Software Configuration (CPE)

## Nebula Graph Database

```bash
# mkdir /data/nebula
# cd /data/nebula
git clone -b v2.6.0 https://github.com/vesoft-inc/nebula-docker-compose.git
cd nebula-docker-compose
# patch to new version
sed -i "s/2.6.0/2.6.1/g" docker-compose.yaml
docker-compose up -d
```
```
# connect to nebula cluster from consle
docker run --rm -ti --network=docker_nebula-net vesoft/nebula-console:v2.6.0 \
       -u root -p password --addr=graphd --port=9669
```

## Data Model

```sql
# Create script
CREATE SPACE IF NOT EXISTS secure(vid_type=int64, partition_num=30, replica_factor=1);
USE secure;
CREATE TAG repo(name string, description string);
CREATE TAG code(name string, description string, language string);
CREATE TAG cve(name string, description string, cvss_v3 string, type string, publish_date date);
CREATE EDGE has(version string, range_from string, range_to string);
CREATE EDGE cpe(version string, range_from string, range_to string);
CREATE EDGE ref();
```
---

<p align="center">
  <img src="images/data-model.png" width="600" title="Data Model">
</p>

---

## Example from dataset

```
Note: We will use prefix for code elements to distinguish between same library names in different languages
```
```
-----
repo: (vertex)
-----
name: vesoft-inc/nebula
description: "Nebula Graph is an open-source graph database capable of hosting super large scale graphs \
              with dozens of billions of vertices (nodes) and trillions of edges, with milliseconds of latency."
-----
code: (vertex)
-----
name: "pypi/pytest"
description: "The pytest framework makes it easy to write small tests, yet scales to support complex \
              functional testing for applications and libraries."
language:python
name: "pypi/filelock"
description: "This package contains a single module, which implements a platform independent file lock \
              in Python, which provides a simple way of inter-process communication"
language: python
-----------
has: (edge)
-----------
vesoft-inc/nebula -> pypi/pytest
version: "==5.3.2"
range_from: 5.3.2
range_to: 5.3.2
vesoft-inc/nebula -> py/pifilelock
version: "==3.0.12"
range_from: 3.0.12
range_to: 3.0.12
----
cve: (vertex)
----
name: "CVE-2020-29651"
description: "A denial of service via regular expression in the py.path.svnwc component of py (aka python-py) \
              through 1.9.0 could be used by attackers to cause a compute-time denial of service attack by \
              supplying malicious input to the blame functionality."
cvss_v3: "5.0"
type: "DoS"
publish_date: "2020-12-09"
-----------
cpe: (edge)
-----------
CVE-2020-29651 -> pypi/pytest
version: "==5.3.2"
range_from: 3.0.12
range_to: 3.0.12
```
