# Graph Your Code Vulnerability

<p align="center">
  <br> <a href="README.md">English</a> | 中文
</p>

本项目是一个帮助检验 GitHub 项目的 CVE 漏洞情况并可视化洞察分析结果的工具。

应该有公开的操作范例网站。
这里，我们会对于大多数流行的 GitHub Repo 抽取图的对象，让用户可以选择其中任何一个 GitHub Repo，去进行漏洞检查（非常帅气的可视化效果），并支持全文搜索。

## 我们收集什么数据

#### GitHub 数据
- Repo 名字 name
- 依赖库和可执行文件
- 链到的其他 Repo

#### CVE & NVD 数据
- CVE 名字
- 描述
- CVSS v3 基础分
- 已知的受影响配置（CPE）

## Nebula Graph 图数据库

```bash
# mkdir /data/nebula
# cd /data/nebula
git clone -b v2.6.0 https://github.com/vesoft-inc/nebula-docker-compose.git
cd nebula-docker-compose
# patch to new version
sed -i "s/2.6.0/2.6.1/g" docker-compose.yaml
docker-compose up -d
```
```
# connect to nebula cluster from consle
docker run --rm -ti --network=docker_nebula-net vesoft/nebula-console:v2.6.0 \
       -u root -p password --addr=graphd --port=9669
```

## 数据建模

```sql
# Create script
CREATE SPACE IF NOT EXISTS secure(vid_type=int64, partition_num=30, replica_factor=1);
USE secure;
CREATE TAG repo(name string, description string);
CREATE TAG code(name string, description string, language string);
CREATE TAG cve(name string, description string, cvss_v3 string, type string, publish_date date);
CREATE EDGE has(version string, range_from string, range_to string);
CREATE EDGE cpe(version string, range_from string, range_to string);
CREATE EDGE ref();
```
---

<p align="center">
  <img src="images/data-model.png" width="600" title="Data Model">
</p>

---

## 数据集中的例子

```
注意：我们会用语言前缀区分同名不同语言的库。
```
```
-----
repo: (vertex)
-----
name: vesoft-inc/nebula
description: "Nebula Graph is an open-source graph database capable of hosting super large scale graphs \
              with dozens of billions of vertices (nodes) and trillions of edges, with milliseconds of latency."
-----
code: (vertex)
-----
name: "pypi/pytest"
description: "The pytest framework makes it easy to write small tests, yet scales to support complex \
              functional testing for applications and libraries."
language:python
name: "pypi/filelock"
description: "This package contains a single module, which implements a platform independent file lock \
              in Python, which provides a simple way of inter-process communication"
language: python
-----------
has: (edge)
-----------
vesoft-inc/nebula -> pypi/pytest
version: "==5.3.2"
range_from: 5.3.2
range_to: 5.3.2
vesoft-inc/nebula -> py/pifilelock
version: "==3.0.12"
range_from: 3.0.12
range_to: 3.0.12
----
cve: (vertex)
----
name: "CVE-2020-29651"
description: "A denial of service via regular expression in the py.path.svnwc component of py (aka python-py) \
              through 1.9.0 could be used by attackers to cause a compute-time denial of service attack by \
              supplying malicious input to the blame functionality."
cvss_v3: "5.0"
type: "DoS"
publish_date: "2020-12-09"
-----------
cpe: (edge)
-----------
CVE-2020-29651 -> pypi/pytest
version: "==5.3.2"
range_from: 3.0.12
range_to: 3.0.12
```
